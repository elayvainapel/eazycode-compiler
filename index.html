<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>eazyCode Online Compiler</title>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #1d283a 0, #020617 55%, #000 100%);
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      padding: 32px 12px;
    }

    .shell {
      width: 100%;
      max-width: 1100px;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      box-shadow:
        0 22px 45px rgba(15, 23, 42, 0.8),
        0 0 0 1px rgba(15, 23, 42, 0.8);
      overflow: hidden;
      backdrop-filter: blur(22px);
    }

    .header {
      padding: 14px 20px 10px;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
      display: flex;
      align-items: center;
      gap: 10px;
      background: linear-gradient(to right, #020617, #020617, #111827);
    }

    .traffic-dots {
      display: flex;
      gap: 6px;
      margin-right: 4px;
    }

    .traffic-dots span {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      display: inline-block;
    }
    .dot-red { background: #f97373; }
    .dot-yellow { background: #facc15; }
    .dot-green { background: #22c55e; }

    .title-area {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .title-main {
      font-size: 16px;
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .title-sub {
      font-size: 12px;
      color: #9ca3af;
    }

    .badge {
      margin-left: auto;
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: #c4d4ff;
      background: radial-gradient(circle at top left, #1d4ed8, #020617);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .main {
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
      min-height: 420px;
    }

    .panel {
      display: flex;
      flex-direction: column;
      border-right: 1px solid rgba(31, 41, 55, 0.9);
    }
    .panel:last-child { border-right: none; }

    .panel-header {
      padding: 8px 16px;
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
      background: radial-gradient(circle at top left, #0f172a, #020617);
      display: flex;
      align-items: center;
      gap: 8px;
      color: #9ca3af;
    }

    .panel-header span.label {
      font-weight: 600;
      color: #e5e7eb;
    }

    .panel-header span.hint {
      font-size: 11px;
      margin-left: 6px;
      color: #6b7280;
    }

    .panel-header .header-right {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .panel-body {
      padding: 10px 12px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      height: 100%;
    }

    textarea {
      width: 100%;
      flex: 1;
      resize: none;
      border-radius: 10px;
      background: #020617;
      border: 1px solid rgba(55, 65, 81, 0.98);
      color: #e5e7eb;
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
      padding: 10px 11px;
      outline: none;
      line-height: 1.45;
      tab-size: 2;
      box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.8);
    }
    textarea:focus {
      border-color: #22c55e;
      box-shadow:
        0 0 0 1px rgba(34, 197, 94, 0.7),
        0 0 0 6px rgba(22, 163, 74, 0.25);
    }

    pre {
      margin: 0;
      flex: 1;
      border-radius: 10px;
      background: #020617;
      border: 1px solid rgba(55, 65, 81, 0.98);
      color: #e5e7eb;
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 13px;
      padding: 10px 11px;
      line-height: 1.45;
      white-space: pre-wrap;
      word-break: break-word;
      box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.8);
    }

    .controls {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 6px;
      gap: 8px;
    }

    .hint-ghost {
      font-size: 11px;
      color: #6b7280;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 7px 16px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(135deg, #22c55e, #4ade80);
      color: #052e16;
      box-shadow:
        0 10px 18px rgba(34, 197, 94, 0.35),
        0 0 0 1px rgba(22, 163, 74, 0.7);
    }
    button:hover {
      background: linear-gradient(135deg, #4ade80, #bbf7d0);
      transform: translateY(-0.5px);
      box-shadow:
        0 14px 24px rgba(34, 197, 94, 0.4),
        0 0 0 1px rgba(22, 163, 74, 0.9);
    }
    button:active {
      transform: translateY(1px);
      box-shadow:
        0 6px 10px rgba(34, 197, 94, 0.3),
        0 0 0 1px rgba(22, 163, 74, 0.7);
    }

    .btn-icon {
      width: 14px;
      height: 14px;
      border-radius: 999px;
      border: 2px solid #052e16;
      background: #bbf7d0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 9px;
    }

    .status {
      font-size: 11px;
      color: #9ca3af;
    }

    .status-dot {
      display: inline-block;
      width: 7px;
      height: 7px;
      border-radius: 999px;
      margin-right: 5px;
      background: #6b7280;
    }
    .status.success { color: #4ade80; }
    .status.error { color: #f97373; }
    .status.success .status-dot { background: #22c55e; }
    .status.error .status-dot { background: #f97373; }

    @media (max-width: 860px) {
      .main { grid-template-columns: minmax(0, 1fr); }
      .panel { border-right: none; border-bottom: 1px solid rgba(31, 41, 55, 0.9); }
      .panel:last-child { border-bottom: none; }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="header">
      <div class="traffic-dots">
        <span class="dot-red"></span>
        <span class="dot-yellow"></span>
        <span class="dot-green"></span>
      </div>
      <div class="title-area">
        <div class="title-main">eazyCode Online Compiler</div>
        <div class="title-sub">Code inside Main.main(main.execute(1)) like Java, but yours</div>
      </div>
      <div class="badge">v0.1 · class + main</div>
    </div>

    <div class="main">
      <!-- Left: Editor -->
      <div class="panel">
        <div class="panel-header">
          <span class="label">Editor</span>
          <span class="hint">Wrap your code in class Main &amp; main.execute(1)</span>
          <div class="header-right">
            <button type="button" onclick="runEazyCode()">
              <span class="btn-icon">▶</span>
              Run
            </button>
          </div>
        </div>
        <div class="panel-body">
          <textarea id="code" spellcheck="false">public class Main {
    public static void main(main.execute(1)) {
        // eazyCode here

        int a = 4;
        int b = first.Int("hfdsjkgheu7473qhlhrq784r");
        int c = sum.Int("fhriafhriafif74t87eatht32ththtp8");

        console.print(a)+.dl();  // 4
        console.print(b)+.dl();  // 7473
        console.print(c)+.dl();  // 201

        for (int i:range++(1,5)){
            console.print("nice ");
        }
        console.print()+.dl();
    }
}</textarea>

          <div class="controls">
            <span id="status" class="status">
              <span class="status-dot"></span>
              Ready
            </span>
            <span class="hint-ghost">Only the code inside main(main.execute(1)) is compiled</span>
          </div>
        </div>
      </div>

      <!-- Right: Output -->
      <div class="panel">
        <div class="panel-header">
          <span class="label">Output</span>
          <span class="hint">Result of your eazyCode program</span>
        </div>
        <div class="panel-body">
          <pre id="output"></pre>
          <div class="controls">
            <span class="hint-ghost">console.print(...) and +.dl() appear here</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const outputEl = document.getElementById("output");
    const statusEl = document.getElementById("status");

    const eazyConsole = {
      print(value = "") {
        outputEl.textContent += String(value);
        return this;
      },
      dl() {
        outputEl.textContent += "\n";
        return this;
      },
      ul() {
        outputEl.textContent += "\n";
        return this;
      }
    };

    function setStatus(text, type = "normal") {
      statusEl.textContent = "";
      const dot = document.createElement("span");
      dot.className = "status-dot";
      statusEl.className = "status";
      if (type === "success") statusEl.classList.add("success");
      if (type === "error") statusEl.classList.add("error");
      statusEl.appendChild(dot);
      statusEl.appendChild(document.createTextNode(" " + text));
    }

    function first_Int(s) {
      const m = String(s).match(/\d+/);
      return m ? parseInt(m[0], 10) : 0;
    }
    function sum_Int(s) {
      const matches = String(s).match(/\d+/g) || [];
      return matches.reduce((acc, x) => acc + parseInt(x, 10), 0);
    }
    function eachSum_Int(s) {
      const digits = String(s).match(/\d/g) || [];
      return digits.reduce((acc, d) => acc + parseInt(d, 10), 0);
    }
    function eachFirst_Int(s) {
      const m = String(s).match(/\d/);
      return m ? parseInt(m[0], 10) : 0;
    }

    // Extract only the body of main(main.execute(1))
    function extractMainBody(source) {
      const sig = "public static void main(main.execute(1))";
      const sigIndex = source.indexOf(sig);
      if (sigIndex === -1) {
        throw new Error("main.execute(1) method not found");
      }
      const braceStart = source.indexOf("{", sigIndex);
      if (braceStart === -1) {
        throw new Error("Opening { for main.execute(1) not found");
      }
      let depth = 1;
      const n = source.length;
      let bodyStart = braceStart + 1;
      for (let i = braceStart + 1; i < n; i++) {
        const ch = source[i];
        if (ch === "{") depth++;
        else if (ch === "}") {
          depth--;
          if (depth === 0) {
            const bodyEnd = i; // position of closing brace
            return source.slice(bodyStart, bodyEnd);
          }
        }
      }
      throw new Error("Could not find matching } for main.execute(1)");
    }

    function translateExpression(expr) {
      let e = expr.trim();
      e = e.replace(/first\.Int/g, "first_Int");
      e = e.replace(/sum\.Int/g, "sum_Int");
      e = e.replace(/eachSum\.Int/g, "eachSum_Int");
      e = e.replace(/eachFirst\.Int/g, "eachFirst_Int");
      return e;
    }

    function compileEazy(code) {
      const lines = code.split(/\r?\n/);
      const out = [];

      for (let raw of lines) {
        let line = raw;
        const trimmed = line.trim();

        if (trimmed === "") {
          out.push("");
          continue;
        }
        if (trimmed.startsWith("//")) {
          out.push("//" + trimmed.slice(2));
          continue;
        }

        // console.print(...)+.dl();
        {
          const m = trimmed.match(/^console\.print\((.*)\)\s*\+\s*\.dl\(\)\s*;?$/);
          if (m) {
            const inner = m[1].trim();
            if (inner) {
              const jsExpr = translateExpression(inner);
              out.push(`eazyConsole.print(${jsExpr});`);
            } else {
              out.push(`eazyConsole.print("");`);
            }
            out.push(`eazyConsole.dl();`);
            continue;
          }
        }

        // console.print(...);
        {
          const m = trimmed.match(/^console\.print\((.*)\)\s*;?$/);
          if (m) {
            const inner = m[1].trim();
            if (inner) {
              const jsExpr = translateExpression(inner);
              out.push(`eazyConsole.print(${jsExpr});`);
            } else {
              out.push(`eazyConsole.print("");`);
            }
            continue;
          }
        }

        // declarations: int / String / var
        {
          const m = trimmed.match(/^(int|String|var)\s+([A-Za-z_]\w*)\s*=\s*(.+);?$/);
          if (m) {
            const name = m[2];
            const expr = translateExpression(m[3]);
            out.push(`let ${name} = ${expr};`);
            continue;
          }
        }

        // for (int i:range++(1,5)){
        {
          const m = trimmed.match(
            /^for\s*\(\s*int\s+([A-Za-z_]\w*)\s*:\s*range\+\+\(\s*(.+)\s*,\s*(.+)\s*\)\s*\)\s*\{?$/,
          );
          if (m) {
            const varName = m[1];
            const start = translateExpression(m[2]);
            const end = translateExpression(m[3]);
            out.push(
              `for (let ${varName} = ${start}; ${varName} <= ${end}; ${varName}++) {`,
            );
            continue;
          }
        }

        // if / else if / while
        if (
          trimmed.startsWith("if ") ||
          trimmed.startsWith("else if ") ||
          trimmed.startsWith("while ")
        ) {
          const idxOpen = line.indexOf("(");
          const idxClose = line.lastIndexOf(")");
          if (idxOpen !== -1 && idxClose !== -1 && idxClose > idxOpen) {
            const before = line.slice(0, idxOpen + 1);
            const expr = line.slice(idxOpen + 1, idxClose);
            const after = line.slice(idxClose);
            line = before + translateExpression(expr) + after;
          }
          out.push(line);
          continue;
        }

        // assignment
        {
          const m = trimmed.match(/^([A-Za-z_]\w*)\s*=\s*(.+);?$/);
          if (m && !trimmed.startsWith("for ")) {
            const name = m[1];
            const expr = translateExpression(m[2]);
            out.push(`${name} = ${expr};`);
            continue;
          }
        }

        // fallback
        line = line.replace(/first\.Int/g, "first_Int");
        line = line.replace(/sum\.Int/g, "sum_Int");
        line = line.replace(/eachSum\.Int/g, "eachSum_Int");
        line = line.replace(/eachFirst\.Int/g, "eachFirst_Int");
        out.push(line);
      }

      return out.join("\n");
    }

    function runEazyCode() {
      const fullSource = document.getElementById("code").value;
      outputEl.textContent = "";
      setStatus("Extracting main...", "normal");

      try {
        const body = extractMainBody(fullSource);
        setStatus("Compiling...", "normal");
        const js = compileEazy(body);
        setStatus("Running...", "normal");
        eval(js);
        setStatus("Done", "success");
      } catch (err) {
        outputEl.textContent += "\n[Error] " + err.message;
        setStatus("Error", "error");
      }
    }
  </script>
</body>
</html>
